<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1jour1histoire - Chaque jour une surprise !</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: url('https://github.com/1jour1histoirs/1jour1histoires/blob/main/C22094C5-71B2-4004-8502-2CEC644F56B3.png?raw=true') center/cover no-repeat fixed;
            min-height: 100vh;
            color: white;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: -1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        .welcome-message {
            text-align: center;
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 2px solid #4a90e2;
            box-shadow: 0 4px 20px rgba(74, 144, 226, 0.3);
        }

        .welcome-message h1 {
            font-size: clamp(1.5rem, 4vw, 2.5rem);
            margin-bottom: 10px;
            color: #4a90e2;
        }

        .welcome-message p {
            font-size: clamp(1rem, 2.5vw, 1.3rem);
            opacity: 0.9;
        }

        .controls {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 30px;
        }

        .category-selector {
            background: rgba(0, 0, 0, 0.9);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #4a90e2;
        }

        .category-selector label {
            display: block;
            margin-bottom: 10px;
            font-size: 1.1rem;
            color: #4a90e2;
            font-weight: 600;
        }

        .category-selector select {
            width: 100%;
            padding: 12px 16px;
            font-size: 16px;
            background: #1a1a1a;
            color: white;
            border: 2px solid #4a90e2;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .category-selector select:focus {
            outline: none;
            border-color: #6bb6ff;
            box-shadow: 0 0 10px rgba(107, 182, 255, 0.5);
        }

        .chapters-container {
            background: rgba(0, 0, 0, 0.9);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #4a90e2;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
            display: none;
        }

        .chapters-container.show {
            opacity: 1;
            transform: translateY(0);
            display: block;
        }

        .chapters-title {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: #4a90e2;
            text-align: center;
            font-weight: 600;
        }

        .chapters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .chapter-button {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
        }

        .chapter-button:hover {
            background: linear-gradient(135deg, #357abd, #2c5f99);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(74, 144, 226, 0.4);
        }

        .chapter-button:active {
            transform: translateY(0);
        }

        .story-display {
            background: rgba(20, 20, 20, 0.95);
            padding: 25px;
            border-radius: 10px;
            border: 2px solid #4a90e2;
            margin-top: 20px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.4s ease;
            display: none;
            line-height: 1.6;
        }

        .story-display.show {
            opacity: 1;
            transform: translateY(0);
            display: block;
        }

        .quiz-container {
            background: rgba(20, 20, 20, 0.95);
            padding: 25px;
            border-radius: 10px;
            border: 2px solid #4a90e2;
            margin-top: 20px;
        }

        .quiz-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .quiz-score {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            display: inline-block;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .quiz-question {
            background: rgba(74, 144, 226, 0.1);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #4a90e2;
            margin-bottom: 20px;
        }

        .quiz-question h3 {
            color: #4a90e2;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .quiz-answers {
            display: grid;
            gap: 10px;
        }

        .quiz-answer {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid #4a90e2;
            color: white;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .quiz-answer:hover {
            background: rgba(74, 144, 226, 0.2);
            transform: translateX(5px);
        }

        .quiz-answer.correct {
            background: linear-gradient(135deg, #28a745, #20c997);
            border-color: #28a745;
            animation: correctAnswer 0.5s ease;
        }

        .quiz-answer.wrong {
            background: linear-gradient(135deg, #dc3545, #e74c3c);
            border-color: #dc3545;
            animation: wrongAnswer 0.5s ease;
        }

        .quiz-answer.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        @keyframes correctAnswer {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes wrongAnswer {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
            100% { transform: translateX(0); }
        }

        .quiz-next {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            margin: 20px auto;
            display: none;
            transition: all 0.3s ease;
        }

        .quiz-next:hover {
            background: linear-gradient(135deg, #357abd, #2c5f99);
            transform: translateY(-2px);
        }

        .quiz-next.show {
            display: block;
        }

        .quiz-results {
            text-align: center;
            padding: 30px;
            background: rgba(74, 144, 226, 0.1);
            border-radius: 10px;
            border: 2px solid #4a90e2;
        }

        .quiz-results h2 {
            color: #4a90e2;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .quiz-results .final-score {
            font-size: 2rem;
            font-weight: bold;
            margin: 20px 0;
        }

        .quiz-results .score-excellent {
            color: #28a745;
        }

        .quiz-results .score-good {
            color: #ffc107;
        }

        .quiz-results .score-needs-improvement {
            color: #dc3545;
        }

        .quiz-restart {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .quiz-restart:hover {
            background: linear-gradient(135deg, #20c997, #17a085);
            transform: translateY(-2px);
        }

        .memo-container {
            background: rgba(20, 20, 20, 0.95);
            padding: 25px;
            border-radius: 10px;
            border: 2px solid #4a90e2;
            margin-top: 20px;
        }

        .memo-phase {
            text-align: center;
        }

        .memo-story {
            background: rgba(74, 144, 226, 0.1);
            padding: 25px;
            border-radius: 10px;
            border: 1px solid #4a90e2;
            margin: 20px 0;
            line-height: 1.6;
            font-size: 1.1rem;
        }

        .memo-timer {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
            padding: 15px 25px;
            border-radius: 20px;
            display: inline-block;
            font-weight: bold;
            font-size: 1.3rem;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
            animation: timerPulse 1s infinite;
        }

        @keyframes timerPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .memo-timer.warning {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            animation: timerWarning 0.5s infinite;
        }

        .memo-timer.danger {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            animation: timerDanger 0.3s infinite;
        }

        @keyframes timerWarning {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes timerDanger {
            0% { transform: scale(1); box-shadow: 0 4px 15px rgba(244, 67, 54, 0.4); }
            50% { transform: scale(1.15); box-shadow: 0 6px 25px rgba(244, 67, 54, 0.8); }
            100% { transform: scale(1); box-shadow: 0 4px 15px rgba(244, 67, 54, 0.4); }
        }

        .memo-question {
            background: rgba(74, 144, 226, 0.1);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #4a90e2;
            margin: 20px 0;
        }

        .memo-question h3 {
            color: #4a90e2;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .memo-input {
            width: 100%;
            padding: 15px;
            font-size: 18px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid #4a90e2;
            border-radius: 8px;
            color: white;
            margin: 15px 0;
            transition: all 0.3s ease;
        }

        .memo-input:focus {
            outline: none;
            border-color: #6bb6ff;
            box-shadow: 0 0 10px rgba(107, 182, 255, 0.5);
            background: rgba(255, 255, 255, 0.15);
        }

        .memo-submit {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            margin: 15px 0;
            transition: all 0.3s ease;
        }

        .memo-submit:hover:not(:disabled) {
            background: linear-gradient(135deg, #357abd, #2c5f99);
            transform: translateY(-2px);
        }

        .memo-submit:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .memo-result {
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .memo-result.success {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }

        .memo-result.failure {
            background: linear-gradient(135deg, #dc3545, #e74c3c);
            color: white;
        }

        .memo-restart {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .memo-restart:hover {
            background: linear-gradient(135deg, #20c997, #17a085);
            transform: translateY(-2px);
        }

        .story-display h3 {
            color: #4a90e2;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .social-links {
            text-align: center;
            margin-top: 40px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            align-items: center;
        }

        .tiktok-container {
            text-align: center;
        }

        .paypal-container {
            text-align: center;
        }

        .paypal-button {
            display: inline-block;
            background: linear-gradient(135deg, #ffc439, #ff8c00);
            color: #333;
            text-decoration: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(255, 196, 57, 0.4);
            border: 2px solid #ffc439;
        }

        .paypal-button:hover {
            background: linear-gradient(135deg, #ff8c00, #e67300);
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(255, 196, 57, 0.6);
            color: #333;
        }

        .tiktok-button {
            display: inline-block;
            background: linear-gradient(135deg, #ff0050, #ff0080);
            color: white;
            text-decoration: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(255, 0, 80, 0.4);
            border: 2px solid #ff0050;
        }

        .tiktok-button:hover {
            background: linear-gradient(135deg, #ff0080, #e6006b);
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(255, 0, 80, 0.6);
            color: white;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .chapters-grid {
                grid-template-columns: 1fr;
            }

            .welcome-message {
                padding: 15px;
                margin-bottom: 20px;
            }

            .story-display {
                padding: 20px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }

            .welcome-message {
                padding: 12px;
            }

            .category-selector,
            .chapters-container {
                padding: 15px;
            }

            .paypal-button,
            .tiktok-button {
                padding: 12px 25px;
                font-size: 1rem;
            }

            .social-links {
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="welcome-message">
            <h1>📚 Bienvenue sur 1jour1histoire</h1>
            <p>Chaque jour une surprise !</p>
        </div>

        <div class="controls">
            <div class="category-selector">
                <label for="category">Choisissez votre catégorie :</label>
                <select id="category">
                    <option value="">-- Sélectionnez une catégorie --</option>
                    <option value="enfant">Histoire Enfant</option>
                    <option value="adulte">Histoire Adulte</option>
                    <option value="religion">Histoire Religion</option>
                    <option value="quiz">🧠 Quiz Interactif</option>
                    <option value="memo">🧠 Mémo 30 secondes</option>
                    <option value="enigme">🔍 Énigmes</option>
                </select>
            </div>

            <div class="chapters-container" id="chapters-container">
                <div class="chapters-title" id="chapters-title">Chapitres disponibles</div>
                <div class="chapters-grid" id="chapters-grid">
                    <!-- Chapitres générés dynamiquement -->
                </div>
                <div class="story-display" id="story-display">
                    <!-- Histoire affichée ici -->
                </div>
            </div>
        </div>

        <div class="social-links">
            <div class="tiktok-container">
                <a href="https://www.tiktok.com/@1jour1hiistoires?_t=ZN-8x0JWagYNk6&_r=1" 
                   target="_blank" 
                   class="tiktok-button">
                    🎵 Suivez-nous sur TikTok @1jour1hiistoires
                </a>
            </div>
            
            <div class="paypal-container">
                <a href="https://www.paypal.com/donate?business=mbkauto42%40gmail.com" 
                   target="_blank" 
                   class="paypal-button">
                    👉 Aider à me faire grandir 💛
                </a>
            </div>
        </div>
    </div>

    <script>
        const enigmeData = {
            enigmes: [
                {
                    enigme: "🧮 Je suis un nombre. Si tu me multiplies par 2 puis que tu m'ajoutes 6, tu obtiens 16. Qui suis-je ?",
                    answers: ["A) 5", "B) 10", "C) 8"],
                    correct: 0,
                    explication: "Si x × 2 + 6 = 16, alors x × 2 = 10, donc x = 5"
                },
                {
                    enigme: "🏠 Dans une maison, il y a 4 coins. Dans chaque coin, il y a un chat. Chaque chat voit 3 autres chats. Combien y a-t-il de chats en tout ?",
                    answers: ["A) 12 chats", "B) 4 chats", "C) 16 chats"],
                    correct: 1,
                    explication: "Il y a 4 chats au total, un dans chaque coin. Chacun voit les 3 autres."
                },
                {
                    enigme: "🕐 Il est maintenant 15h. Dans combien d'heures l'aiguille des heures et celle des minutes se superposeront-elles pour la première fois ?",
                    answers: ["A) Dans 3h20", "B) Dans 2h10", "C) Dans 1h05"],
                    correct: 2,
                    explication: "Les aiguilles se superposent à 16h05, soit dans 1h05."
                },
                {
                    enigme: "🔤 Quel est le mot de 5 lettres qui devient plus court quand on lui ajoute 2 lettres ?",
                    answers: ["A) Court", "B) Petit", "C) Grand"],
                    correct: 0,
                    explication: "Le mot 'Court' devient 'Plus court' quand on ajoute 'Plus'."
                },
                {
                    enigme: "🚗 Un conducteur descend une rue à sens unique dans le mauvais sens. Il croise 3 policiers mais aucun ne l'arrête. Pourquoi ?",
                    answers: ["A) Il est invisible", "B) Il marche à pied", "C) C'est son père"],
                    correct: 1,
                    explication: "Il marche à pied ! On peut marcher dans les deux sens dans une rue à sens unique."
                },
                {
                    enigme: "🎂 Marie a 8 ans aujourd'hui. Sa mère a 3 fois son âge. Dans combien d'années la mère aura-t-elle 2 fois l'âge de Marie ?",
                    answers: ["A) Dans 8 ans", "B) Dans 16 ans", "C) Dans 12 ans"],
                    correct: 0,
                    explication: "La mère a 24 ans. Dans 8 ans : Marie 16 ans, sa mère 32 ans (2×16)."
                },
                {
                    enigme: "💡 Plus on m'enlève, plus je deviens grand. Qui suis-je ?",
                    answers: ["A) Un trou", "B) Une dette", "C) L'espace"],
                    correct: 0,
                    explication: "Un trou : plus on enlève de terre, plus le trou devient grand."
                },
                {
                    enigme: "🧩 Dans une course, tu dépasses le 2ème. À quelle position te trouves-tu maintenant ?",
                    answers: ["A) 1ère position", "B) 2ème position", "C) 3ème position"],
                    correct: 1,
                    explication: "Tu prends la place du 2ème, donc tu es maintenant 2ème."
                },
                {
                    enigme: "🔥 Qu'est-ce qui peut voyager autour du monde en restant dans un coin ?",
                    answers: ["A) Un timbre", "B) Une araignée", "C) La poussière"],
                    correct: 0,
                    explication: "Un timbre postal reste dans le coin d'une enveloppe qui voyage."
                },
                {
                    enigme: "⚖️ Tu as 12 boules identiques en apparence, mais l'une d'elles est plus lourde. Avec une balance à 2 plateaux, combien de pesées minimum faut-il pour la trouver ?",
                    answers: ["A) 2 pesées", "B) 3 pesées", "C) 4 pesées"],
                    correct: 1,
                    explication: "Avec 3 pesées maximum : diviser en 3 groupes de 4, puis affiner."
                },
                {
                    enigme: "🌊 Un bateau part de France vers l'Amérique avec 20 moutons et 15 chèvres. En arrivant, il reste seulement 5 moutons et 8 chèvres. Comment s'appelle le capitaine ?",
                    answers: ["A) Jean-Pierre", "B) Mohammed", "C) C'est votre prénom"],
                    correct: 2,
                    explication: "Piège ! La question demande VOTRE prénom car VOUS êtes le capitaine."
                },
                {
                    enigme: "🏃‍♂️ Paul court toujours mais n'avance jamais. Julie vole mais n'a pas d'ailes. Marc nage mais n'est jamais mouillé. Qui sont-ils ?",
                    answers: ["A) Des sportifs virtuels", "B) Des noms sur un écran", "C) Des aiguilles d'horloge"],
                    correct: 1,
                    explication: "Ce sont des noms affichés sur l'écran d'un ordinateur ou d'un jeu."
                }
            ]
        };

        let currentEnigme = {
            currentQuestion: 0,
            score: 0,
            enigmes: [],
            answered: false
        };

        const quizData = {
            questions: [
                {
                    question: "Quelle est la capitale de la France ?",
                    answers: ["Paris", "Lyon", "Marseille", "Toulouse"],
                    correct: 0
                },
                {
                    question: "Combien de continents y a-t-il sur Terre ?",
                    answers: ["5", "6", "7", "8"],
                    correct: 2
                },
                {
                    question: "Qui a écrit 'Les Misérables' ?",
                    answers: ["Émile Zola", "Victor Hugo", "Gustave Flaubert", "Alexandre Dumas"],
                    correct: 1
                },
                {
                    question: "Quelle est la planète la plus proche du Soleil ?",
                    answers: ["Vénus", "Terre", "Mercure", "Mars"],
                    correct: 2
                },
                {
                    question: "En quelle année a eu lieu la Révolution française ?",
                    answers: ["1789", "1799", "1804", "1815"],
                    correct: 0
                },
                {
                    question: "Quel est le plus grand océan du monde ?",
                    answers: ["Atlantique", "Indien", "Arctique", "Pacifique"],
                    correct: 3
                },
                {
                    question: "Combien de côtés a un hexagone ?",
                    answers: ["5", "6", "7", "8"],
                    correct: 1
                },
                {
                    question: "Qui a peint 'La Joconde' ?",
                    answers: ["Pablo Picasso", "Vincent van Gogh", "Leonardo da Vinci", "Claude Monet"],
                    correct: 2
                },
                {
                    question: "Quelle est la langue la plus parlée au monde ?",
                    answers: ["Anglais", "Mandarin", "Espagnol", "Hindi"],
                    correct: 1
                },
                {
                    question: "Combien de minutes y a-t-il dans une heure ?",
                    answers: ["50", "60", "70", "80"],
                    correct: 1
                }
            ]
        };

        let currentQuiz = {
            currentQuestion: 0,
            score: 0,
            questions: [],
            answered: false
        };

        const memoQuestions = {
            enfant: [
                { 
                    question: "Comment s'appelait la petite fée dans l'histoire ?", 
                    answers: ["A) Luna", "B) Stella", "C) Iris"], 
                    correct: 0,
                    explanation: "La petite fée s'appelait Luna et vivait dans un jardin magique."
                },
                { 
                    question: "Quel animal était l'ami de Félix dans l'histoire ?", 
                    answers: ["A) Un lapin", "B) Un écureuil", "C) Un hérisson"], 
                    correct: 1,
                    explanation: "Félix le renard avait pour ami l'écureuil Noisette."
                },
                { 
                    question: "Quel pouvoir avait la princesse Étoile ?", 
                    answers: ["A) Contrôler le vent", "B) Faire apparaître des étoiles filantes", "C) Parler aux animaux"], 
                    correct: 1,
                    explanation: "La princesse Étoile pouvait faire apparaître des étoiles filantes."
                },
                { 
                    question: "Que créait Léo le dragon au lieu de cracher du feu ?", 
                    answers: ["A) Des bulles multicolores", "B) De la fumée rose", "C) Des étincelles dorées"], 
                    correct: 0,
                    explanation: "Léo créait de magnifiques bulles multicolores qui rendaient tout le monde heureux."
                },
                { 
                    question: "Que gardait la sirène Perle ?", 
                    answers: ["A) Un trésor sous-marin", "B) Un phare magique", "C) Une grotte secrète"], 
                    correct: 1,
                    explanation: "La sirène Perle gardait un phare magique qui guidait les bateaux perdus."
                }
            ],
            adulte: [
                { 
                    question: "Depuis combien d'années Marie tenait-elle sa boutique ?", 
                    answers: ["A) 30 ans", "B) 40 ans", "C) 50 ans"], 
                    correct: 1,
                    explanation: "Marie tenait sa boutique de fleurs depuis 40 ans."
                },
                { 
                    question: "Quel était le métier de Thomas ?", 
                    answers: ["A) Architecte", "B) Ingénieur", "C) Menuisier"], 
                    correct: 0,
                    explanation: "Thomas était architecte et maintenant à la retraite."
                },
                { 
                    question: "Quel type d'établissement Sophie a-t-elle ouvert ?", 
                    answers: ["A) Une boulangerie", "B) Un café-librairie", "C) Une galerie d'art"], 
                    correct: 1,
                    explanation: "Sophie a quitté son travail de cadre pour ouvrir un café-librairie."
                },
                { 
                    question: "Après combien d'années Jean a-t-il retrouvé son premier amour ?", 
                    answers: ["A) 25 ans", "B) 30 ans", "C) 35 ans"], 
                    correct: 1,
                    explanation: "Jean a retrouvé son premier amour après 30 ans lors d'une réunion d'anciens élèves."
                },
                { 
                    question: "Quel était le métier d'Élise ?", 
                    answers: ["A) Journaliste", "B) Photographe", "C) Réalisatrice"], 
                    correct: 1,
                    explanation: "Élise était photographe de guerre avant de se reconvertir."
                }
            ],
            religion: [
                { 
                    question: "Comment s'appelait le frère du monastère ?", 
                    answers: ["A) Antoine", "B) François", "C) Bernard"], 
                    correct: 0,
                    explanation: "Le frère Antoine passait ses journées à copier des manuscrits anciens."
                },
                { 
                    question: "Comment s'appelait la jeune femme en pèlerinage ?", 
                    answers: ["A) Marie", "B) Sarah", "C) Claire"], 
                    correct: 1,
                    explanation: "Sarah était la jeune femme en quête de spiritualité qui entreprit un pèlerinage à pied."
                },
                { 
                    question: "Comment s'appelait le curé du village ?", 
                    answers: ["A) Pierre", "B) Michel", "C) Paul"], 
                    correct: 1,
                    explanation: "Le père Michel était le curé d'un village isolé."
                },
                { 
                    question: "Comment s'appelait le rabbin ?", 
                    answers: ["A) Samuel", "B) David", "C) Isaac"], 
                    correct: 1,
                    explanation: "Le rabbin David organisait des dîners pour les personnes seules dans sa synagogue."
                },
                { 
                    question: "Comment s'appelait la jeune musulmane ?", 
                    answers: ["A) Fatima", "B) Amina", "C) Aicha"], 
                    correct: 1,
                    explanation: "Amina était la jeune musulmane qui luttait pour concilier sa foi et sa vie moderne."
                }
            ]
        };

        let currentMemo = {
            category: '',
            chapter: 0,
            question: {},
            timer: null,
            timeLeft: 30,
            phase: 'reading', // 'reading', 'questioning', 'finished'
            answered: false
        };

        const stories = {
            enfant: {
                title: "Histoires pour Enfants - Quiz",
                chapters: {
                    1: {
                        story: "Il était une fois une petite fée nommée Luna qui vivait dans un jardin magique. Un jour, elle découvrit que toutes les fleurs avaient perdu leurs couleurs. Avec l'aide de ses amis les papillons, elle partit à la recherche de l'arc-en-ciel perdu pour redonner vie à son jardin.",
                        questions: [
                            {
                                question: "Comment s'appelait la petite fée de l'histoire ?",
                                answers: ["A) Luna", "B) Stella", "C) Aurora"],
                                correct: 0,
                                explanation: "La petite fée s'appelait Luna et vivait dans un jardin magique."
                            },
                            {
                                question: "Que découvrit Luna dans son jardin ?",
                                answers: ["A) Que les fleurs étaient fanées", "B) Que les fleurs avaient perdu leurs couleurs", "C) Que les fleurs parlaient"],
                                correct: 1,
                                explanation: "Luna découvrit que toutes les fleurs avaient perdu leurs couleurs."
                            },
                            {
                                question: "Qui aida Luna dans sa quête ?",
                                answers: ["A) Les oiseaux", "B) Les papillons", "C) Les abeilles"],
                                correct: 1,
                                explanation: "Luna partit à la recherche de l'arc-en-ciel avec l'aide de ses amis les papillons."
                            }
                        ]
                    },
                    2: {
                        story: "Dans une forêt enchantée, un petit renard curieux nommé Félix découvrit une carte au trésor. Il décida de partir à l'aventure avec son ami l'écureuil Noisette. Ensemble, ils apprirent que le véritable trésor était leur amitié.",
                        questions: [
                            {
                                question: "Comment s'appelait le petit renard ?",
                                answers: ["A) Félix", "B) Oscar", "C) Roux"],
                                correct: 0,
                                explanation: "Le petit renard curieux s'appelait Félix."
                            },
                            {
                                question: "Qu'est-ce que Félix découvrit ?",
                                answers: ["A) Un livre magique", "B) Une carte au trésor", "C) Une grotte secrète"],
                                correct: 1,
                                explanation: "Félix découvrit une carte au trésor dans la forêt enchantée."
                            },
                            {
                                question: "Quel était le véritable trésor découvert ?",
                                answers: ["A) De l'or", "B) Des pierres précieuses", "C) L'amitié"],
                                correct: 2,
                                explanation: "Félix et Noisette apprirent que le véritable trésor était leur amitié."
                            }
                        ]
                    },
                    3: {
                        story: "La princesse Étoile avait un pouvoir spécial : elle pouvait faire apparaître des étoiles filantes. Un soir, elle remarqua qu'un petit village était triste car ils n'avaient jamais vu d'étoiles. Elle décida de leur offrir la plus belle nuit étoilée de leur vie.",
                        questions: [
                            {
                                question: "Quel était le pouvoir de la princesse Étoile ?",
                                answers: ["A) Contrôler le vent", "B) Faire apparaître des étoiles filantes", "C) Parler aux animaux"],
                                correct: 1,
                                explanation: "La princesse Étoile pouvait faire apparaître des étoiles filantes."
                            },
                            {
                                question: "Pourquoi le village était-il triste ?",
                                answers: ["A) Il pleuvait toujours", "B) Ils n'avaient jamais vu d'étoiles", "C) Ils étaient pauvres"],
                                correct: 1,
                                explanation: "Le petit village était triste car ses habitants n'avaient jamais vu d'étoiles."
                            },
                            {
                                question: "Que décida de faire la princesse ?",
                                answers: ["A) Partir en voyage", "B) Offrir la plus belle nuit étoilée", "C) Construire un château"],
                                correct: 1,
                                explanation: "La princesse décida d'offrir au village la plus belle nuit étoilée de leur vie."
                            }
                        ]
                    },
                    4: {
                        story: "Léo le petit dragon ne savait pas cracher du feu comme les autres dragons. Il était très triste jusqu'au jour où il découvrit qu'il pouvait créer de magnifiques bulles multicolores qui rendaient tout le monde heureux.",
                        questions: [
                            {
                                question: "Que ne savait pas faire Léo comme les autres dragons ?",
                                answers: ["A) Voler", "B) Cracher du feu", "C) Rugir"],
                                correct: 1,
                                explanation: "Léo ne savait pas cracher du feu comme les autres dragons."
                            },
                            {
                                question: "Que découvrit Léo qu'il savait faire ?",
                                answers: ["A) Créer des bulles multicolores", "B) Chanter", "C) Danser"],
                                correct: 0,
                                explanation: "Léo découvrit qu'il pouvait créer de magnifiques bulles multicolores."
                            },
                            {
                                question: "Quel effet avaient les bulles de Léo ?",
                                answers: ["A) Elles explosaient", "B) Elles rendaient tout le monde heureux", "C) Elles sentaient bon"],
                                correct: 1,
                                explanation: "Les bulles multicolores de Léo rendaient tout le monde heureux."
                            }
                        ]
                    },
                    5: {
                        story: "Dans un royaume sous-marin, la sirène Perle gardait un phare magique qui guidait les bateaux perdus. Quand une terrible tempête éteignit sa lumière, elle dut faire appel au courage de tous les poissons pour rallumer l'espoir.",
                        questions: [
                            {
                                question: "Que gardait la sirène Perle ?",
                                answers: ["A) Un trésor", "B) Un phare magique", "C) Un palais"],
                                correct: 1,
                                explanation: "La sirène Perle gardait un phare magique sous-marin."
                            },
                            {
                                question: "À quoi servait le phare magique ?",
                                answers: ["A) À éclairer le royaume", "B) À guider les bateaux perdus", "C) À effrayer les ennemis"],
                                correct: 1,
                                explanation: "Le phare magique guidait les bateaux perdus."
                            },
                            {
                                question: "Qui aida Perle à rallumer l'espoir ?",
                                answers: ["A) Les dauphins", "B) Tous les poissons", "C) Les baleines"],
                                correct: 1,
                                explanation: "Perle fit appel au courage de tous les poissons pour rallumer l'espoir."
                            }
                        ]
                    }
                }
            },
            adulte: {
                title: "Histoires pour Adultes - Quiz",
                chapters: {
                    1: {
                        story: "Marie ferma sa boutique de fleurs pour la dernière fois après 40 ans. En rangeant, elle découvrit une lettre cachée depuis des décennies. Cette lettre allait changer sa perspective sur toute sa vie et lui révéler un secret gardé par sa grand-mère.",
                        questions: [
                            {
                                question: "Depuis combien de temps Marie tenait-elle sa boutique ?",
                                answers: ["A) 30 ans", "B) 40 ans", "C) 50 ans"],
                                correct: 1,
                                explanation: "Marie ferma sa boutique de fleurs après 40 ans d'activité."
                            },
                            {
                                question: "Que découvrit Marie en rangeant ?",
                                answers: ["A) Un journal intime", "B) Une lettre cachée", "C) Une photo ancienne"],
                                correct: 1,
                                explanation: "En rangeant, Marie découvrit une lettre cachée depuis des décennies."
                            },
                            {
                                question: "Qui avait gardé le secret révélé par la lettre ?",
                                answers: ["A) Sa mère", "B) Sa grand-mère", "C) Sa sœur"],
                                correct: 1,
                                explanation: "La lettre révélait un secret gardé par sa grand-mère."
                            }
                        ]
                    },
                    2: {
                        story: "Thomas, architecte à la retraite, décida de construire une petite cabane dans les bois. Ce projet simple devint une quête de sens qui le reconnecta avec la nature et avec lui-même, lui apprenant que les plus belles créations naissent de la simplicité.",
                        questions: [
                            {
                                question: "Quel était le métier de Thomas ?",
                                answers: ["A) Architecte", "B) Ingénieur", "C) Menuisier"],
                                correct: 0,
                                explanation: "Thomas était architecte et maintenant à la retraite."
                            },
                            {
                                question: "Que décida de construire Thomas ?",
                                answers: ["A) Une maison", "B) Une cabane dans les bois", "C) Un garage"],
                                correct: 1,
                                explanation: "Thomas décida de construire une petite cabane dans les bois."
                            },
                            {
                                question: "Que lui apprit ce projet ?",
                                answers: ["A) Que le travail est difficile", "B) Que les plus belles créations naissent de la simplicité", "C) Qu'il était trop vieux"],
                                correct: 1,
                                explanation: "Ce projet lui apprit que les plus belles créations naissent de la simplicité."
                            }
                        ]
                    },
                    3: {
                        story: "À 50 ans, Sophie quitta son travail de cadre pour ouvrir un café-librairie. Cette décision bouleversa sa vie et celle de son quartier, prouvant qu'il n'est jamais trop tard pour suivre ses rêves et créer du lien social.",
                        questions: [
                            {
                                question: "À quel âge Sophie changea-t-elle de vie ?",
                                answers: ["A) 45 ans", "B) 50 ans", "C) 55 ans"],
                                correct: 1,
                                explanation: "Sophie avait 50 ans quand elle quitta son travail de cadre."
                            },
                            {
                                question: "Qu'ouvrit Sophie après avoir quitté son travail ?",
                                answers: ["A) Un restaurant", "B) Un café-librairie", "C) Une boutique"],
                                correct: 1,
                                explanation: "Sophie ouvrit un café-librairie après avoir quitté son travail de cadre."
                            },
                            {
                                question: "Que prouva la décision de Sophie ?",
                                answers: ["A) Que l'argent ne fait pas le bonheur", "B) Qu'il n'est jamais trop tard pour suivre ses rêves", "C) Que le travail est important"],
                                correct: 1,
                                explanation: "Sa décision prouva qu'il n'est jamais trop tard pour suivre ses rêves."
                            }
                        ]
                    },
                    4: {
                        story: "Jean retrouva par hasard son premier amour après 30 ans lors d'une réunion d'anciens élèves. Leur conversation d'une nuit leur fit comprendre que certaines connexions transcendent le temps et les circonstances de la vie.",
                        questions: [
                            {
                                question: "Après combien d'années Jean retrouva-t-il son premier amour ?",
                                answers: ["A) 25 ans", "B) 30 ans", "C) 35 ans"],
                                correct: 1,
                                explanation: "Jean retrouva son premier amour après 30 ans."
                            },
                            {
                                question: "Où se retrouvèrent-ils ?",
                                answers: ["A) Dans un café", "B) À une réunion d'anciens élèves", "C) Dans la rue"],
                                correct: 1,
                                explanation: "Ils se retrouvèrent lors d'une réunion d'anciens élèves."
                            },
                            {
                                question: "Que leur fit comprendre leur conversation ?",
                                answers: ["A) Qu'ils avaient changé", "B) Que certaines connexions transcendent le temps", "C) Qu'ils étaient trop vieux"],
                                correct: 1,
                                explanation: "Leur conversation leur fit comprendre que certaines connexions transcendent le temps."
                            }
                        ]
                    },
                    5: {
                        story: "Élise, photographe de guerre fatiguée, décida de documenter la beauté ordinaire de sa ville natale. Ce projet artistique la guérit de ses traumatismes et lui redonna foi en l'humanité à travers les petits gestes du quotidien.",
                        questions: [
                            {
                                question: "Quel était le métier d'Élise ?",
                                answers: ["A) Journaliste", "B) Photographe de guerre", "C) Artiste"],
                                correct: 1,
                                explanation: "Élise était photographe de guerre et se sentait fatiguée."
                            },
                            {
                                question: "Que décida de documenter Élise ?",
                                answers: ["A) Les conflits", "B) La beauté ordinaire de sa ville", "C) Les célébrités"],
                                correct: 1,
                                explanation: "Élise décida de documenter la beauté ordinaire de sa ville natale."
                            },
                            {
                                question: "Quel effet eut ce projet sur Élise ?",
                                answers: ["A) Il l'ennuya", "B) Il la guérit et lui redonna foi en l'humanité", "C) Il la rendit triste"],
                                correct: 1,
                                explanation: "Ce projet la guérit de ses traumatismes et lui redonna foi en l'humanité."
                            }
                        ]
                    }
                }
            },
            religion: {
                title: "Histoires Religieuses - Quiz",
                chapters: {
                    1: {
                        story: "Dans un petit monastère, le frère Antoine passait ses journées à copier des manuscrits anciens. Un jour, il découvrit entre les pages d'un livre saint une prière oubliée qui apportait une paix profonde à tous ceux qui la récitaient.",
                        questions: [
                            {
                                question: "Comment s'appelait le frère du monastère ?",
                                answers: ["A) Antoine", "B) François", "C) Bernard"],
                                correct: 0,
                                explanation: "Le frère Antoine passait ses journées à copier des manuscrits anciens."
                            },
                            {
                                question: "Que faisait le frère Antoine chaque jour ?",
                                answers: ["A) Il priait", "B) Il copiait des manuscrits", "C) Il jardinait"],
                                correct: 1,
                                explanation: "Le frère Antoine passait ses journées à copier des manuscrits anciens."
                            },
                            {
                                question: "Que découvrit-il dans un livre saint ?",
                                answers: ["A) Une illustration", "B) Une prière oubliée", "C) Une carte"],
                                correct: 1,
                                explanation: "Il découvrit une prière oubliée qui apportait une paix profonde."
                            }
                        ]
                    },
                    2: {
                        story: "Sarah, jeune femme en quête de spiritualité, entreprit un pèlerinage à pied. Chaque étape de son voyage lui enseigna une nouvelle leçon sur la foi, la persévérance et la générosité des âmes qu'elle rencontrait sur son chemin.",
                        questions: [
                            {
                                question: "Comment s'appelait la jeune femme ?",
                                answers: ["A) Marie", "B) Sarah", "C) Claire"],
                                correct: 1,
                                explanation: "Sarah était une jeune femme en quête de spiritualité."
                            },
                            {
                                question: "Comment entreprit-elle son pèlerinage ?",
                                answers: ["A) En voiture", "B) À pied", "C) À vélo"],
                                correct: 1,
                                explanation: "Sarah entreprit un pèlerinage à pied."
                            },
                            {
                                question: "Que lui enseigna chaque étape ?",
                                answers: ["A) La patience", "B) Des leçons sur la foi et la persévérance", "C) L'humilité"],
                                correct: 1,
                                explanation: "Chaque étape lui enseigna des leçons sur la foi, la persévérance et la générosité."
                            }
                        ]
                    },
                    3: {
                        story: "Le père Michel, curé d'un village isolé, vit sa foi ébranlée par les difficultés de ses paroissiens. C'est en aidant une famille dans le besoin qu'il redécouvrit le véritable sens de sa vocation et la force de la communauté.",
                        questions: [
                            {
                                question: "Comment s'appelait le curé ?",
                                answers: ["A) Pierre", "B) Michel", "C) Paul"],
                                correct: 1,
                                explanation: "Le père Michel était curé d'un village isolé."
                            },
                            {
                                question: "Qu'est-ce qui ébranla sa foi ?",
                                answers: ["A) Une maladie", "B) Les difficultés de ses paroissiens", "C) Une dispute"],
                                correct: 1,
                                explanation: "Sa foi fut ébranlée par les difficultés de ses paroissiens."
                            },
                            {
                                question: "Comment redécouvrit-il sa vocation ?",
                                answers: ["A) En priant", "B) En aidant une famille dans le besoin", "C) En voyageant"],
                                correct: 1,
                                explanation: "Il redécouvrit sa vocation en aidant une famille dans le besoin."
                            }
                        ]
                    },
                    4: {
                        story: "Dans une synagogue centenaire, le rabbin David organisait chaque vendredi un dîner pour les personnes seules. Ces repas partagés créèrent des liens profonds et montrèrent comment les traditions peuvent rassembler au-delà des différences.",
                        questions: [
                            {
                                question: "Comment s'appelait le rabbin ?",
                                answers: ["A) Samuel", "B) David", "C) Isaac"],
                                correct: 1,
                                explanation: "Le rabbin David organisait des dîners dans sa synagogue."
                            },
                            {
                                question: "Que faisait le rabbin chaque vendredi ?",
                                answers: ["A) Il priait seul", "B) Il organisait un dîner pour les personnes seules", "C) Il étudiait"],
                                correct: 1,
                                explanation: "Chaque vendredi, il organisait un dîner pour les personnes seules."
                            },
                            {
                                question: "Que montrèrent ces repas partagés ?",
                                answers: ["A) L'importance de la nourriture", "B) Comment les traditions peuvent rassembler", "C) La richesse de la communauté"],
                                correct: 1,
                                explanation: "Ces repas montrèrent comment les traditions peuvent rassembler au-delà des différences."
                            }
                        ]
                    },
                    5: {
                        story: "Amina, jeune musulmane, luttait pour concilier sa foi et sa vie moderne. À travers les enseignements de sa grand-mère et la méditation, elle apprit que la spiritualité peut s'épanouir dans tous les aspects de la vie quotidienne.",
                        questions: [
                            {
                                question: "Comment s'appelait la jeune musulmane ?",
                                answers: ["A) Fatima", "B) Amina", "C) Aicha"],
                                correct: 1,
                                explanation: "Amina était une jeune musulmane en quête d'équilibre."
                            },
                            {
                                question: "Avec quoi luttait-elle ?",
                                answers: ["A) Sa famille", "B) Concilier sa foi et sa vie moderne", "C) Ses études"],
                                correct: 1,
                                explanation: "Amina luttait pour concilier sa foi et sa vie moderne."
                            },
                            {
                                question: "Qu'apprit-elle grâce à sa grand-mère ?",
                                answers: ["A) Que la foi est difficile", "B) Que la spiritualité peut s'épanouir partout", "C) Qu'il faut être parfaite"],
                                correct: 1,
                                explanation: "Elle apprit que la spiritualité peut s'épanouir dans tous les aspects de la vie quotidienne."
                            }
                        ]
                    }
                }
            }
        };

        const categorySelect = document.getElementById('category');
        const chaptersContainer = document.getElementById('chapters-container');
        const chaptersTitle = document.getElementById('chapters-title');
        const chaptersGrid = document.getElementById('chapters-grid');
        const storyDisplay = document.getElementById('story-display');

        categorySelect.addEventListener('change', function() {
            const selectedCategory = this.value;
            
            if (selectedCategory) {
                showChapters(selectedCategory);
            } else {
                hideChapters();
            }
        });

        function showChapters(category) {
            if (category === 'quiz') {
                showQuiz();
                return;
            }
            
            if (category === 'memo') {
                showMemo();
                return;
            }
            
            if (category === 'enigme') {
                showEnigme();
                return;
            }
            
            const categoryData = stories[category];
            
            // Mise à jour du titre
            chaptersTitle.textContent = categoryData.title;
            
            // Création des boutons de chapitres
            chaptersGrid.innerHTML = '';
            for (let i = 1; i <= 5; i++) {
                const button = document.createElement('button');
                button.className = 'chapter-button';
                button.textContent = `Chapitre ${i}`;
                button.addEventListener('click', () => showStory(category, i));
                chaptersGrid.appendChild(button);
            }
            
            // Masquer l'histoire précédente
            storyDisplay.classList.remove('show');
            
            // Afficher les chapitres avec animation
            setTimeout(() => {
                chaptersContainer.classList.add('show');
            }, 100);
        }

        function hideChapters() {
            chaptersContainer.classList.remove('show');
            storyDisplay.classList.remove('show');
        }

        function showStory(category, chapterNumber) {
            // Initialiser le quiz de l'histoire
            currentStory = {
                category: category,
                chapter: chapterNumber,
                currentQuestion: 0,
                score: 0,
                answered: false,
                data: stories[category].chapters[chapterNumber]
            };
            
            // Afficher l'histoire puis commencer le quiz
            showStoryReading();
        }

        let currentStory = {
            category: '',
            chapter: 0,
            currentQuestion: 0,
            score: 0,
            answered: false,
            data: {}
        };

        function showStoryReading() {
            storyDisplay.innerHTML = `
                <div class="quiz-container">
                    <h2 style="color: #4a90e2; margin-bottom: 20px;">📖 Chapitre ${currentStory.chapter}</h2>
                    <p style="color: #ffc107; font-weight: 600; margin-bottom: 20px;">
                        Lisez attentivement cette histoire, puis répondez aux questions !
                    </p>
                    
                    <div class="memo-story">
                        <p style="line-height: 1.8; font-size: 1.1rem;">${currentStory.data.story}</p>
                    </div>
                    
                    <div style="text-align: center; margin-top: 25px;">
                        <button class="memo-submit" onclick="startStoryQuiz()">
                            🧠 Commencer le quiz sur cette histoire
                        </button>
                    </div>
                </div>
            `;
            
            // Masquer puis afficher avec animation
            storyDisplay.classList.remove('show');
            setTimeout(() => {
                storyDisplay.classList.add('show');
            }, 100);
        }

        function startStoryQuiz() {
            createStoryQuizInterface();
        }

        function createStoryQuizInterface() {
            const currentQuestion = currentStory.data.questions[currentStory.currentQuestion];
            
            storyDisplay.innerHTML = `
                <div class="quiz-container">
                    <div class="quiz-header">
                        <div class="quiz-score">
                            Score: <span id="current-story-score">${currentStory.score}</span>/${currentStory.data.questions.length}
                        </div>
                        <div style="color: #4a90e2; font-weight: 600;">
                            Question <span id="story-question-number">${currentStory.currentQuestion + 1}</span> sur ${currentStory.data.questions.length}
                        </div>
                    </div>
                    
                    <div class="quiz-question">
                        <h3 id="story-question-text">${currentQuestion.question}</h3>
                        <div class="quiz-answers" id="story-answers">
                            ${currentQuestion.answers.map((answer, index) => 
                                `<button class="quiz-answer" onclick="selectStoryAnswer(${index})">${answer}</button>`
                            ).join('')}
                        </div>
                    </div>
                    
                    <div style="text-align: center;">
                        <button class="quiz-next" id="story-next-button" onclick="nextStoryQuestion()">
                            ${currentStory.currentQuestion < currentStory.data.questions.length - 1 ? 'Question suivante' : 'Voir les résultats'}
                        </button>
                    </div>
                    
                    <div id="story-explanation" style="display: none; background: rgba(74, 144, 226, 0.1); padding: 15px; border-radius: 8px; margin-top: 15px; border: 1px solid #4a90e2;">
                        <p style="color: #4a90e2; font-weight: 600; margin-bottom: 8px;">💡 Explication :</p>
                        <p style="color: white; font-size: 0.95rem;"></p>
                    </div>
                </div>
            `;
        }

        function selectStoryAnswer(selectedIndex) {
            if (currentStory.answered) return;
            
            currentStory.answered = true;
            const correctIndex = currentStory.data.questions[currentStory.currentQuestion].correct;
            const answers = document.querySelectorAll('.quiz-answer');
            const explanation = currentStory.data.questions[currentStory.currentQuestion].explanation;
            
            answers.forEach((answer, index) => {
                answer.classList.add('disabled');
                if (index === correctIndex) {
                    answer.classList.add('correct');
                } else if (index === selectedIndex) {
                    answer.classList.add('wrong');
                }
            });
            
            if (selectedIndex === correctIndex) {
                currentStory.score++;
                document.getElementById('current-story-score').textContent = currentStory.score;
            }
            
            // Afficher l'explication
            const explanationDiv = document.getElementById('story-explanation');
            explanationDiv.querySelector('p:last-child').textContent = explanation;
            explanationDiv.style.display = 'block';
            
            document.getElementById('story-next-button').classList.add('show');
        }

        function nextStoryQuestion() {
            currentStory.currentQuestion++;
            currentStory.answered = false;
            
            if (currentStory.currentQuestion < currentStory.data.questions.length) {
                // Question suivante
                const currentQuestion = currentStory.data.questions[currentStory.currentQuestion];
                
                document.getElementById('story-question-number').textContent = currentStory.currentQuestion + 1;
                document.getElementById('story-question-text').textContent = currentQuestion.question;
                
                const answersContainer = document.getElementById('story-answers');
                answersContainer.innerHTML = currentQuestion.answers.map((answer, index) => 
                    `<button class="quiz-answer" onclick="selectStoryAnswer(${index})">${answer}</button>`
                ).join('');
                
                const nextButton = document.getElementById('story-next-button');
                nextButton.classList.remove('show');
                nextButton.textContent = currentStory.currentQuestion < currentStory.data.questions.length - 1 ? 'Question suivante' : 'Voir les résultats';
                
                // Masquer l'explication précédente
                document.getElementById('story-explanation').style.display = 'none';
            } else {
                // Afficher les résultats
                showStoryResults();
            }
        }

        function showStoryResults() {
            const percentage = Math.round((currentStory.score / currentStory.data.questions.length) * 100);
            let scoreClass, message;
            
            if (percentage >= 80) {
                scoreClass = 'score-excellent';
                message = "📚 Excellent ! Vous avez bien retenu l'histoire !";
            } else if (percentage >= 60) {
                scoreClass = 'score-good';
                message = "👍 Bien joué ! Bonne compréhension de l'histoire !";
            } else {
                scoreClass = 'score-needs-improvement';
                message = "📖 Relisez l'histoire pour mieux la retenir !";
            }
            
            storyDisplay.innerHTML = `
                <div class="quiz-results">
                    <h2>🏆 Résultats du Chapitre ${currentStory.chapter}</h2>
                    <div class="final-score ${scoreClass}">
                        ${currentStory.score}/${currentStory.data.questions.length}
                    </div>
                    <div class="final-score ${scoreClass}">
                        ${percentage}%
                    </div>
                    <p style="font-size: 1.2rem; margin: 20px 0; color: white;">
                        ${message}
                    </p>
                    <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                        <button class="quiz-restart" onclick="showStoryReading()">
                            📖 Relire l'histoire
                        </button>
                        <button class="quiz-restart" onclick="startStoryQuiz()" style="background: linear-gradient(135deg, #4a90e2, #357abd);">
                            🔄 Refaire le quiz
                        </button>
                    </div>
                </div>
            `;
        }

        function showQuiz() {
            // Initialiser le quiz
            currentQuiz.currentQuestion = 0;
            currentQuiz.score = 0;
            currentQuiz.questions = [...quizData.questions].sort(() => Math.random() - 0.5).slice(0, 5);
            currentQuiz.answered = false;
            
            // Mise à jour du titre
            chaptersTitle.textContent = "🧠 Quiz Interactif - Testez vos connaissances !";
            
            // Masquer les boutons de chapitres
            chaptersGrid.style.display = 'none';
            
            // Masquer l'histoire précédente
            storyDisplay.classList.remove('show');
            
            // Créer l'interface de quiz
            createQuizInterface();
            
            // Afficher le conteneur avec animation
            setTimeout(() => {
                chaptersContainer.classList.add('show');
            }, 100);
        }

        function createQuizInterface() {
            chaptersGrid.innerHTML = `
                <div class="quiz-container">
                    <div class="quiz-header">
                        <div class="quiz-score">
                            Score: <span id="current-score">${currentQuiz.score}</span>/${currentQuiz.questions.length}
                        </div>
                        <div style="color: #4a90e2; font-weight: 600;">
                            Question <span id="question-number">${currentQuiz.currentQuestion + 1}</span> sur ${currentQuiz.questions.length}
                        </div>
                    </div>
                    
                    <div class="quiz-question">
                        <h3 id="question-text">${currentQuiz.questions[currentQuiz.currentQuestion].question}</h3>
                        <div class="quiz-answers" id="quiz-answers">
                            ${currentQuiz.questions[currentQuiz.currentQuestion].answers.map((answer, index) => 
                                `<button class="quiz-answer" onclick="selectAnswer(${index})">${answer}</button>`
                            ).join('')}
                        </div>
                    </div>
                    
                    <div style="text-align: center;">
                        <button class="quiz-next" id="next-button" onclick="nextQuestion()">
                            ${currentQuiz.currentQuestion < currentQuiz.questions.length - 1 ? 'Question suivante' : 'Voir les résultats'}
                        </button>
                    </div>
                </div>
            `;
            chaptersGrid.style.display = 'block';
        }

        function selectAnswer(selectedIndex) {
            if (currentQuiz.answered) return;
            
            currentQuiz.answered = true;
            const correctIndex = currentQuiz.questions[currentQuiz.currentQuestion].correct;
            const answers = document.querySelectorAll('.quiz-answer');
            
            answers.forEach((answer, index) => {
                answer.classList.add('disabled');
                if (index === correctIndex) {
                    answer.classList.add('correct');
                } else if (index === selectedIndex) {
                    answer.classList.add('wrong');
                }
            });
            
            if (selectedIndex === correctIndex) {
                currentQuiz.score++;
                document.getElementById('current-score').textContent = currentQuiz.score;
            }
            
            document.getElementById('next-button').classList.add('show');
        }

        function nextQuestion() {
            currentQuiz.currentQuestion++;
            currentQuiz.answered = false;
            
            if (currentQuiz.currentQuestion < currentQuiz.questions.length) {
                // Question suivante
                document.getElementById('question-number').textContent = currentQuiz.currentQuestion + 1;
                document.getElementById('question-text').textContent = currentQuiz.questions[currentQuiz.currentQuestion].question;
                
                const answersContainer = document.getElementById('quiz-answers');
                answersContainer.innerHTML = currentQuiz.questions[currentQuiz.currentQuestion].answers.map((answer, index) => 
                    `<button class="quiz-answer" onclick="selectAnswer(${index})">${answer}</button>`
                ).join('');
                
                const nextButton = document.getElementById('next-button');
                nextButton.classList.remove('show');
                nextButton.textContent = currentQuiz.currentQuestion < currentQuiz.questions.length - 1 ? 'Question suivante' : 'Voir les résultats';
            } else {
                // Afficher les résultats
                showQuizResults();
            }
        }

        function showQuizResults() {
            const percentage = Math.round((currentQuiz.score / currentQuiz.questions.length) * 100);
            let scoreClass, message;
            
            if (percentage >= 80) {
                scoreClass = 'score-excellent';
                message = "🎉 Excellent ! Vous maîtrisez bien vos connaissances !";
            } else if (percentage >= 60) {
                scoreClass = 'score-good';
                message = "👍 Bien joué ! Vous avez de bonnes connaissances !";
            } else {
                scoreClass = 'score-needs-improvement';
                message = "💪 Continuez à apprendre, vous progresserez !";
            }
            
            chaptersGrid.innerHTML = `
                <div class="quiz-results">
                    <h2>🏆 Résultats du Quiz</h2>
                    <div class="final-score ${scoreClass}">
                        ${currentQuiz.score}/${currentQuiz.questions.length}
                    </div>
                    <div class="final-score ${scoreClass}">
                        ${percentage}%
                    </div>
                    <p style="font-size: 1.2rem; margin: 20px 0; color: white;">
                        ${message}
                    </p>
                    <button class="quiz-restart" onclick="restartQuiz()">
                        🔄 Recommencer le quiz
                    </button>
                </div>
            `;
        }

        function restartQuiz() {
            showQuiz();
        }

        function showMemo() {
            // Mise à jour du titre
            chaptersTitle.textContent = "🧠 Mémo 30 secondes - Testez votre mémoire !";
            
            // Masquer les boutons de chapitres
            chaptersGrid.style.display = 'none';
            
            // Masquer l'histoire précédente
            storyDisplay.classList.remove('show');
            
            // Créer l'interface de sélection
            createMemoSelection();
            
            // Afficher le conteneur avec animation
            setTimeout(() => {
                chaptersContainer.classList.add('show');
            }, 100);
        }

        function createMemoSelection() {
            chaptersGrid.innerHTML = `
                <div class="memo-container">
                    <div class="memo-phase">
                        <h2 style="color: #4a90e2; margin-bottom: 20px;">🧠 Mémo 30 secondes</h2>
                        <p style="font-size: 1.1rem; margin-bottom: 30px; color: white;">
                            Choisissez une catégorie et un chapitre. Vous aurez le temps de lire l'histoire, 
                            puis 30 secondes pour répondre à une question de mémoire !
                        </p>
                        
                        <div style="display: grid; gap: 15px; max-width: 400px; margin: 0 auto;">
                            <select id="memo-category" class="memo-input" style="cursor: pointer;">
                                <option value="">-- Choisissez une catégorie --</option>
                                <option value="enfant">Histoire Enfant</option>
                                <option value="adulte">Histoire Adulte</option>
                                <option value="religion">Histoire Religion</option>
                            </select>
                            
                            <select id="memo-chapter" class="memo-input" style="cursor: pointer;" disabled>
                                <option value="">-- Choisissez un chapitre --</option>
                            </select>
                            
                            <button class="memo-submit" id="memo-start" onclick="startMemoGame()" disabled>
                                🚀 Commencer le défi mémoire
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            chaptersGrid.style.display = 'block';
            
            // Ajouter les événements
            document.getElementById('memo-category').addEventListener('change', function() {
                const chapterSelect = document.getElementById('memo-chapter');
                const startButton = document.getElementById('memo-start');
                
                if (this.value) {
                    chapterSelect.disabled = false;
                    chapterSelect.innerHTML = `
                        <option value="">-- Choisissez un chapitre --</option>
                        <option value="1">Chapitre 1</option>
                        <option value="2">Chapitre 2</option>
                        <option value="3">Chapitre 3</option>
                        <option value="4">Chapitre 4</option>
                        <option value="5">Chapitre 5</option>
                    `;
                } else {
                    chapterSelect.disabled = true;
                    chapterSelect.innerHTML = '<option value="">-- Choisissez un chapitre --</option>';
                    startButton.disabled = true;
                }
            });
            
            document.getElementById('memo-chapter').addEventListener('change', function() {
                const startButton = document.getElementById('memo-start');
                startButton.disabled = !this.value;
            });
        }

        function startMemoGame() {
            const category = document.getElementById('memo-category').value;
            const chapter = parseInt(document.getElementById('memo-chapter').value);
            
            currentMemo.category = category;
            currentMemo.chapter = chapter;
            currentMemo.question = memoQuestions[category][chapter - 1];
            currentMemo.phase = 'reading';
            
            showMemoReading();
        }

        function showMemoReading() {
            const story = stories[currentMemo.category].chapters[currentMemo.chapter];
            
            chaptersGrid.innerHTML = `
                <div class="memo-container">
                    <div class="memo-phase">
                        <h2 style="color: #4a90e2; margin-bottom: 20px;">📖 Lisez attentivement</h2>
                        <p style="color: #ffc107; font-weight: 600; margin-bottom: 20px;">
                            Prenez le temps de bien lire cette histoire. Vous allez devoir répondre à une question après !
                        </p>
                        
                        <div class="memo-story">
                            <h3 style="color: #4a90e2; margin-bottom: 15px;">Chapitre ${currentMemo.chapter}</h3>
                            <p>${story}</p>
                        </div>
                        
                        <button class="memo-submit" onclick="startMemoTimer()">
                            ✅ J'ai fini de lire, commencer le test !
                        </button>
                    </div>
                </div>
            `;
        }

        function startMemoTimer() {
            currentMemo.phase = 'questioning';
            currentMemo.timeLeft = 30;
            currentMemo.answered = false;
            
            chaptersGrid.innerHTML = `
                <div class="memo-container">
                    <div class="memo-phase">
                        <div class="memo-timer" id="memo-timer">⏰ ${currentMemo.timeLeft} secondes</div>
                        
                        <div class="memo-question">
                            <h3>🧠 Question :</h3>
                            <p style="font-size: 1.1rem; color: white;">${currentMemo.question.question}</p>
                            <p style="color: #ffc107; margin-top: 10px;">➤ T'as 30 secondes pour t'en souvenir.</p>
                        </div>
                        
                        <div class="quiz-answers" id="memo-answers">
                            ${currentMemo.question.answers.map((answer, index) => 
                                `<button class="quiz-answer" onclick="selectMemoAnswer(${index})">${answer}</button>`
                            ).join('')}
                        </div>
                    </div>
                </div>
            `;
            
            // Démarrer le timer
            startTimer();
        }

        function startTimer() {
            currentMemo.timer = setInterval(() => {
                currentMemo.timeLeft--;
                const timerElement = document.getElementById('memo-timer');
                
                if (timerElement) {
                    timerElement.textContent = `⏰ ${currentMemo.timeLeft} secondes`;
                    
                    // Changer les couleurs selon le temps restant
                    if (currentMemo.timeLeft <= 5) {
                        timerElement.className = 'memo-timer danger';
                    } else if (currentMemo.timeLeft <= 10) {
                        timerElement.className = 'memo-timer warning';
                    }
                }
                
                if (currentMemo.timeLeft <= 0) {
                    clearInterval(currentMemo.timer);
                    timeUp();
                }
            }, 1000);
        }

        function selectMemoAnswer(selectedIndex) {
            if (currentMemo.answered) return;
            
            currentMemo.answered = true;
            
            if (currentMemo.timer) {
                clearInterval(currentMemo.timer);
            }
            
            const correctIndex = currentMemo.question.correct;
            const answers = document.querySelectorAll('.quiz-answer');
            
            answers.forEach((answer, index) => {
                answer.classList.add('disabled');
                if (index === correctIndex) {
                    answer.classList.add('correct');
                } else if (index === selectedIndex) {
                    answer.classList.add('wrong');
                }
            });
            
            const isCorrect = selectedIndex === correctIndex;
            const selectedAnswer = currentMemo.question.answers[selectedIndex];
            
            // Attendre un peu pour laisser voir l'animation
            setTimeout(() => {
                showMemoResult(isCorrect, selectedAnswer, false);
            }, 1500);
        }

        function timeUp() {
            if (currentMemo.answered) return;
            
            currentMemo.answered = true;
            const answers = document.querySelectorAll('.quiz-answer');
            const correctIndex = currentMemo.question.correct;
            
            answers.forEach((answer, index) => {
                answer.classList.add('disabled');
                if (index === correctIndex) {
                    answer.classList.add('correct');
                }
            });
            
            setTimeout(() => {
                showMemoResult(false, '', true);
            }, 1500);
        }

        function showMemoResult(isCorrect, userAnswer = '', timeExpired = false) {
            currentMemo.phase = 'finished';
            
            let resultMessage, resultClass;
            
            if (timeExpired) {
                resultMessage = "⏰ Temps écoulé ! Vous n'avez pas répondu à temps.";
                resultClass = "failure";
            } else if (isCorrect) {
                resultMessage = "🎉 Bravo ! Excellente mémoire !";
                resultClass = "success";
            } else {
                resultMessage = "❌ Pas tout à fait... Réessayez pour améliorer votre mémoire !";
                resultClass = "failure";
            }
            
            chaptersGrid.innerHTML = `
                <div class="memo-container">
                    <div class="memo-phase">
                        <h2 style="color: #4a90e2; margin-bottom: 20px;">📊 Résultat</h2>
                        
                        <div class="memo-result ${resultClass}">
                            ${resultMessage}
                        </div>
                        
                        <div style="background: rgba(74, 144, 226, 0.1); padding: 20px; border-radius: 10px; margin: 20px 0;">
                            <p style="color: #4a90e2; font-weight: 600; margin-bottom: 10px;">Question :</p>
                            <p style="color: white; margin-bottom: 15px;">${currentMemo.question.question}</p>
                            
                            <p style="color: #4a90e2; font-weight: 600; margin-bottom: 10px;">Bonne réponse :</p>
                            <p style="color: #28a745; font-weight: 600; margin-bottom: 15px;">${currentMemo.question.answers[currentMemo.question.correct]}</p>
                            
                            ${userAnswer && !timeExpired ? `
                                <p style="color: #4a90e2; font-weight: 600; margin-bottom: 10px;">Votre réponse :</p>
                                <p style="color: ${isCorrect ? '#28a745' : '#dc3545'}; font-weight: 600;">${userAnswer}</p>
                            ` : ''}
                            
                            <div style="margin-top: 15px; padding: 10px; background: rgba(255, 196, 57, 0.1); border-radius: 5px; border-left: 3px solid #ffc439;">
                                <p style="color: #ffc439; font-weight: 600; margin-bottom: 5px;">💡 Explication :</p>
                                <p style="color: white; font-size: 0.95rem;">${currentMemo.question.explanation}</p>
                            </div>
                        </div>
                        
                        <button class="memo-restart" onclick="showMemo()">
                            🔄 Nouveau défi mémoire
                        </button>
                    </div>
                </div>
            `;
        }

        function showEnigme() {
            // Initialiser les énigmes
            currentEnigme.currentQuestion = 0;
            currentEnigme.score = 0;
            currentEnigme.enigmes = [...enigmeData.enigmes].sort(() => Math.random() - 0.5).slice(0, 5);
            currentEnigme.answered = false;
            
            // Mise à jour du titre
            chaptersTitle.textContent = "🔍 Énigmes - Testez votre logique !";
            
            // Masquer les boutons de chapitres
            chaptersGrid.style.display = 'none';
            
            // Masquer l'histoire précédente
            storyDisplay.classList.remove('show');
            
            // Créer l'interface d'énigmes
            createEnigmeInterface();
            
            // Afficher le conteneur avec animation
            setTimeout(() => {
                chaptersContainer.classList.add('show');
            }, 100);
        }

        function createEnigmeInterface() {
            chaptersGrid.innerHTML = `
                <div class="quiz-container">
                    <div class="quiz-header">
                        <div class="quiz-score">
                            Score: <span id="current-enigme-score">${currentEnigme.score}</span>/${currentEnigme.enigmes.length}
                        </div>
                        <div style="color: #4a90e2; font-weight: 600;">
                            Énigme <span id="enigme-number">${currentEnigme.currentQuestion + 1}</span> sur ${currentEnigme.enigmes.length}
                        </div>
                    </div>
                    
                    <div class="quiz-question">
                        <h3 id="enigme-text">${currentEnigme.enigmes[currentEnigme.currentQuestion].enigme}</h3>
                        <div class="quiz-answers" id="enigme-answers">
                            ${currentEnigme.enigmes[currentEnigme.currentQuestion].answers.map((answer, index) => 
                                `<button class="quiz-answer" onclick="selectEnigmeAnswer(${index})">${answer}</button>`
                            ).join('')}
                        </div>
                    </div>
                    
                    <div style="text-align: center;">
                        <button class="quiz-next" id="enigme-next-button" onclick="nextEnigme()">
                            ${currentEnigme.currentQuestion < currentEnigme.enigmes.length - 1 ? 'Énigme suivante' : 'Voir les résultats'}
                        </button>
                    </div>
                    
                    <div id="enigme-explanation" style="display: none; background: rgba(74, 144, 226, 0.1); padding: 15px; border-radius: 8px; margin-top: 15px; border: 1px solid #4a90e2;">
                        <p style="color: #4a90e2; font-weight: 600; margin-bottom: 8px;">💡 Explication :</p>
                        <p style="color: white; font-size: 0.95rem;"></p>
                    </div>
                </div>
            `;
            chaptersGrid.style.display = 'block';
        }

        function selectEnigmeAnswer(selectedIndex) {
            if (currentEnigme.answered) return;
            
            currentEnigme.answered = true;
            const correctIndex = currentEnigme.enigmes[currentEnigme.currentQuestion].correct;
            const answers = document.querySelectorAll('.quiz-answer');
            const explanation = currentEnigme.enigmes[currentEnigme.currentQuestion].explication;
            
            answers.forEach((answer, index) => {
                answer.classList.add('disabled');
                if (index === correctIndex) {
                    answer.classList.add('correct');
                } else if (index === selectedIndex) {
                    answer.classList.add('wrong');
                }
            });
            
            if (selectedIndex === correctIndex) {
                currentEnigme.score++;
                document.getElementById('current-enigme-score').textContent = currentEnigme.score;
            }
            
            // Afficher l'explication
            const explanationDiv = document.getElementById('enigme-explanation');
            explanationDiv.querySelector('p:last-child').textContent = explanation;
            explanationDiv.style.display = 'block';
            
            document.getElementById('enigme-next-button').classList.add('show');
        }

        function nextEnigme() {
            currentEnigme.currentQuestion++;
            currentEnigme.answered = false;
            
            if (currentEnigme.currentQuestion < currentEnigme.enigmes.length) {
                // Énigme suivante
                document.getElementById('enigme-number').textContent = currentEnigme.currentQuestion + 1;
                document.getElementById('enigme-text').textContent = currentEnigme.enigmes[currentEnigme.currentQuestion].enigme;
                
                const answersContainer = document.getElementById('enigme-answers');
                answersContainer.innerHTML = currentEnigme.enigmes[currentEnigme.currentQuestion].answers.map((answer, index) => 
                    `<button class="quiz-answer" onclick="selectEnigmeAnswer(${index})">${answer}</button>`
                ).join('');
                
                const nextButton = document.getElementById('enigme-next-button');
                nextButton.classList.remove('show');
                nextButton.textContent = currentEnigme.currentQuestion < currentEnigme.enigmes.length - 1 ? 'Énigme suivante' : 'Voir les résultats';
                
                // Masquer l'explication précédente
                document.getElementById('enigme-explanation').style.display = 'none';
            } else {
                // Afficher les résultats
                showEnigmeResults();
            }
        }

        function showEnigmeResults() {
            const percentage = Math.round((currentEnigme.score / currentEnigme.enigmes.length) * 100);
            let scoreClass, message;
            
            if (percentage >= 80) {
                scoreClass = 'score-excellent';
                message = "🧠 Génie ! Votre logique est redoutable !";
            } else if (percentage >= 60) {
                scoreClass = 'score-good';
                message = "🤔 Bien raisonné ! Vous avez l'esprit logique !";
            } else {
                scoreClass = 'score-needs-improvement';
                message = "💭 Continuez à vous entraîner, la logique se développe !";
            }
            
            chaptersGrid.innerHTML = `
                <div class="quiz-results">
                    <h2>🏆 Résultats des Énigmes</h2>
                    <div class="final-score ${scoreClass}">
                        ${currentEnigme.score}/${currentEnigme.enigmes.length}
                    </div>
                    <div class="final-score ${scoreClass}">
                        ${percentage}%
                    </div>
                    <p style="font-size: 1.2rem; margin: 20px 0; color: white;">
                        ${message}
                    </p>
                    <button class="quiz-restart" onclick="restartEnigme()">
                        🔄 Nouvelles énigmes
                    </button>
                </div>
            `;
        }

        function restartEnigme() {
            showEnigme();
        }

        // Animation au chargement
        window.addEventListener('load', function() {
            document.body.style.opacity = '0';
            document.body.style.transition = 'opacity 0.5s ease';
            setTimeout(() => {
                document.body.style.opacity = '1';
            }, 100);
        });
    </script>
</body>
</html>
