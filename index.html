<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>1jour1histoire</title>
<style>
  body {
    margin: 0;
    font-family: 'Segoe UI', sans-serif;
    color: #fff;
    background: url('C22094C5-71B2-4004-8502-2CEC644F56B3.png') center/cover fixed no-repeat;
    min-height: 100vh;
    position: relative;
    display: flex;
    justify-content: center;
    padding: 20px;
  }
  body::before {
    content: '';
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.6);
    backdrop-filter: blur(2px);
    z-index: -1;
  }
  .container {
    width: 100%;
    max-width: 600px;
  }
  header {
    text-align: center;
    margin-bottom: 1rem;
  }
  select {
    background: #222;
    color: #fff;
    border: 1px solid #555;
    border-radius: 4px;
    padding: 0.5rem;
    margin-top: 0.5rem;
  }
  .chapters {
    list-style: none;
    padding: 0;
    margin: 1rem 0;
  }
  .chapters li {
    background: rgba(255,255,255,0.1);
    border-radius: 4px;
    padding: 0.5rem;
    margin-bottom: 0.5rem;
    cursor: pointer;
    transition: background 0.3s;
  }
  .chapters li:hover {
    background: rgba(255,255,255,0.2);
  }
  .content {
    background: rgba(255,255,255,0.1);
    border-radius: 4px;
    padding: 1rem;
    display: none;
  }
  .fade {
    animation: fade 0.5s;
  }
  @keyframes fade {
    from {opacity: 0; transform: translateY(-5px);} 
    to {opacity: 1; transform: translateY(0);}
  }
  .paypal-button {
    display: inline-block;
    margin-top: 1rem;
    background: #0070BA;
    color: #fff;
    text-decoration: none;
    padding: 0.7rem 1.2rem;
    border-radius: 4px;
    font-weight: bold;
  }

  .relax-button {
    display: inline-block;
    margin: 1rem 0;
    background: #444;
    color: #fff;
    border: none;
    border-radius: 4px;
    padding: 0.7rem 1.2rem;
    cursor: pointer;
  }
  .relax-button:hover {background: #555;}
  .paypal-button:hover {
    background: #005ea6;
  }
  #quiz-section {margin-top: 2rem;}
  .quiz-button {
    display: inline-block;
    background: #444;
    color: #fff;
    border: none;
    border-radius: 4px;
    padding: 0.7rem 1.2rem;
    cursor: pointer;
    margin-top: 1rem;
  }
  .quiz-button:hover {background:#555;}
  .quiz-option {
    display:block;
    width:100%;
    text-align:left;
    background:#333;
    color:#fff;
    border:1px solid #555;
    border-radius:4px;
    padding:0.5rem;
    margin-top:0.5rem;
    cursor:pointer;
  }
  .quiz-option:hover {background:#444;}
  #quizResult {margin-top:1rem;white-space:pre-wrap;}
  @media (max-width: 600px) {
    header h1 {font-size: 1rem;}
  }
</style>
</head>
<body>
<div class="container">
  <header>
    <h1>üìö Bienvenue sur 1jour1histoire ‚Äì chaque jour une surprise !</h1>
    <label for="category">Choisissez une cat√©gorie :</label>
    <select id="category">
      <option value="" disabled selected>-- Choisir --</option>
      <option value="enfant">Histoire Enfant</option>
      <option value="adulte">Histoire Adulte</option>
      <option value="religion">Histoire Religion</option>
    </select>
  </header>
  <ul id="chapters" class="chapters"></ul>
  <div id="content" class="content"></div>
  <button id="relaxBtn" class="relax-button">Activer son relaxant</button>
  <audio id="relaxAudio" loop>
    <source src="https://cdn.pixabay.com/download/audio/2022/03/31/audio_4b9a93fbe2.mp3?filename=rain-ambient-112784.mp3" type="audio/mpeg">
  </audio>
  <a class="paypal-button" href="https://www.paypal.com/donate?business=mbkauto42%40gmail.com" target="_blank">üëâ Aider √† me faire grandir üíõ</a>
  <div id="quiz-section">
    <h2>Quiz du Jour</h2>
    <button id="startQuizBtn" class="quiz-button">Lancer le quiz</button>
    <div id="quizContainer" style="display:none">
      <p id="quizQuestion"></p>
      <div id="quizOptions"></div>
      <button id="nextQuestionBtn" class="quiz-button" style="display:none">Suivant</button>
    </div>
    <div id="quizResult"></div>
  </div>
</div>
<script>
const chaptersEl = document.getElementById('chapters');
const contentEl = document.getElementById('content');
const categoryEl = document.getElementById('category');
const relaxBtn = document.getElementById('relaxBtn');
const relaxAudio = document.getElementById('relaxAudio');
const startQuizBtn = document.getElementById('startQuizBtn');
const quizContainer = document.getElementById('quizContainer');
const quizQuestion = document.getElementById('quizQuestion');
const quizOptions = document.getElementById('quizOptions');
const nextQuestionBtn = document.getElementById('nextQuestionBtn');
const quizResult = document.getElementById('quizResult');

const data = {
  enfant: Array.from({length:5},(_,i)=>`Conte pour enfants ‚Äì chapitre ${i+1}`),
  adulte: Array.from({length:5},(_,i)=>`R√©cit adulte ‚Äì chapitre ${i+1}`),
  religion: Array.from({length:5},(_,i)=>`Histoire religieuse ‚Äì chapitre ${i+1}`)
};

const questions = [
  {q:'Quel animal raconte les plus belles histoires ?',options:['Le chat','Le lion','Le dromadaire'],a:2},
  {q:"Dans quel desert se cache l'oasis magique ?",options:['Sahara','Gobi','Atacama'],a:0},
  {q:'Combien de jours compte une semaine ?',options:['5','7','9'],a:1},
  {q:'Quelle couleur obtient-on en m√©langeant bleu et jaune ?',options:['Vert','Orange','Violet'],a:0},
  {q:'Le Coran est un livre sacr√© de quelle religion ?',options:['Bouddhisme','Islam','Christianisme'],a:1}
];

let quizIndex = 0;
let quizScore = 0;
let quizSet = [];

function shuffle(a){return a.sort(()=>Math.random()-0.5);}
function speak(txt){
  if('speechSynthesis' in window){
    speechSynthesis.cancel();
    speechSynthesis.speak(new SpeechSynthesisUtterance(txt));
  }
}

function startQuiz(){
  const lock = localStorage.getItem('quizDisabledUntil');
  if(lock && Date.now() < +lock){
    quizResult.textContent = 'Reviens demain pour rejouer !';
    startQuizBtn.disabled = true;
    return;
  }
  quizIndex = 0;
  quizScore = 0;
  quizSet = shuffle([...questions]).slice(0,3);
  startQuizBtn.style.display='none';
  quizResult.textContent='';
  quizContainer.style.display='block';
  showQuestion();
}

function showQuestion(){
  const q = quizSet[quizIndex];
  quizQuestion.textContent = q.q;
  quizOptions.innerHTML='';
  q.options.forEach((opt,i)=>{
    const b=document.createElement('button');
    b.className='quiz-option';
    b.textContent=opt;
    b.onclick=()=>selectAnswer(i);
    quizOptions.appendChild(b);
  });
  nextQuestionBtn.style.display='none';
  speak(q.q);
}

function selectAnswer(i){
  const q=quizSet[quizIndex];
  if(i===q.a) quizScore++;
  Array.from(quizOptions.children).forEach((b,idx)=>{
    b.disabled=true;
    if(idx===q.a) b.style.background='#0070BA';
    if(idx===i && idx!==q.a) b.style.background='#700';
  });
  nextQuestionBtn.style.display='inline-block';
}

nextQuestionBtn.addEventListener('click',()=>{
  quizIndex++;
  if(quizIndex<quizSet.length) showQuestion();
  else endQuiz();
});

function endQuiz(){
  quizContainer.style.display='none';
  quizResult.textContent=`Tu as ${quizScore}/3 bonnes r√©ponses`;
  if(quizScore>=2) quizResult.textContent+=`\nBravo ! Tu d√©bloques une surprise demain üìñüéÅ`;
  startQuizBtn.textContent='Rejouer demain';
  startQuizBtn.style.display='inline-block';
  startQuizBtn.disabled=true;
  localStorage.setItem('quizDisabledUntil', Date.now()+86400000);
}

const lock = localStorage.getItem('quizDisabledUntil');
if(lock && Date.now() < +lock){
  startQuizBtn.textContent='Reviens demain pour rejouer';
  startQuizBtn.disabled=true;
}
startQuizBtn.addEventListener('click', startQuiz);

categoryEl.addEventListener('change', () => {
  const cat = categoryEl.value;
  chaptersEl.innerHTML = '';
  contentEl.style.display = 'none';
  if (!data[cat]) return;
  data[cat].forEach((title, idx) => {
    const li = document.createElement('li');
    li.textContent = `Chapitre ${idx+1}`;
    li.addEventListener('click', () => {
      contentEl.textContent = title;
      contentEl.style.display = 'block';
      contentEl.classList.remove('fade');
      requestAnimationFrame(()=>contentEl.classList.add('fade'));
    });
    chaptersEl.appendChild(li);
  });
  chaptersEl.classList.remove('fade');
  requestAnimationFrame(()=>chaptersEl.classList.add('fade'));
});

relaxBtn.addEventListener('click', () => {
  if (relaxAudio.paused) {
    relaxAudio.play();
    relaxBtn.textContent = 'D√©sactiver son relaxant';
  } else {
    relaxAudio.pause();
    relaxBtn.textContent = 'Activer son relaxant';
  }
});
</script>
</body>
</html>
